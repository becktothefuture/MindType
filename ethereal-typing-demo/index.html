<!doctype html>
<!--
  Ethereal Typing Demo — README
  How to run: open this file (index.html) in a modern desktop browser.
  Controls: type any keys to trigger luminous bursts; drag the X/Y pad (top-right)
            to adjust Density (X) and Energy (Y). Values persist across reloads.
  Performance tips: in `src/main.js`, lower renderer pixelRatio cap or particle cap
                    if your device struggles. This prototype avoids per-frame
                    allocations and uses a single draw call per particle system.
-->
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Ethereal Typing Demo</title>
    <link rel="stylesheet" href="src/styles.css" />
  </head>
  <body>
    <div id="titlebar">
      Ethereal Typing Demo<span class="hint"> — press = to hide/show UI</span>
    </div>
    <canvas id="webgl"></canvas>

    <!-- XY Pad Stack -->
    <div id="xypad-stack"></div>

    <!-- Frosted glass overlay with grain -->
    <div id="glass" style="--blur-amount: 24px">
      <div id="grain"></div>
      <div id="lens" aria-hidden="true"></div>
    </div>

    <!-- FPS badge -->
    <div id="fps">-- fps</div>

    <!-- Live controls -->
    <div id="controls">
      <!-- PRESETS -->
      <div class="control-group">
        <h3>Presets</h3>
        <p class="group-desc">
          Atmospheric moods that capture different facets of the ethereal typing
          experience.
        </p>

        <div id="presets" class="preset-buttons">
          <button data-preset="whisper">Whisper</button>
          <button data-preset="echo">Echo</button>
          <button data-preset="aurora">Aurora</button>
          <button data-preset="glow">Glow</button>
          <button data-preset="symphony">Symphony</button>
          <button data-preset="storm">Storm</button>
          <button data-preset="cosmic">Cosmic</button>
          <button data-preset="deep">Deep</button>
          <button data-preset="mist">Mist</button>
          <button data-preset="aether">Aether</button>
          <button data-preset="dynamo">Dynamo</button>
        </div>

        <button id="resetControls" class="reset-btn">Reset to Defaults</button>
        <button id="toggleUI" class="toggle-btn">Hide UI (=)</button>
      </div>

      <!-- ENERGY SYSTEM -->
      <div class="control-group">
        <h3>Energy System</h3>
        <p class="group-desc">
          Controls how typing energy builds up and decays over time.
        </p>

        <div class="xypad-container" id="density-pad-container"></div>

        <div class="control-row">
          <label for="autoMode">Auto Mode</label>
          <span class="val"></span>
          <input
            id="autoMode"
            type="checkbox"
            checked
            title="Automatically boost effects based on typing rate."
          />
        </div>

        <details class="advanced">
          <summary>Advanced</summary>
          <div class="control-row">
            <label for="meterInc">Energy Gain</label>
            <span class="val" id="meterIncVal">0.08</span>
            <input
              id="meterInc"
              type="range"
              min="0.00"
              max="1.00"
              step="0.01"
              value="0.08"
              title="Energy added to the meter per key press; higher = bigger immediate response."
            />
          </div>

          <div class="control-row">
            <label for="meterDecay">Energy Decay</label>
            <span class="val" id="meterDecayVal">0.05</span>
            <input
              id="meterDecay"
              type="range"
              min="0.00"
              max="2.00"
              step="0.005"
              value="0.05"
              title="How quickly the typing energy meter decays per second; lower = longer lasting energy."
            />
          </div>

          <div class="control-row">
            <label for="autoSens">Auto Sensitivity</label>
            <span class="val" id="autoSensVal">0.60</span>
            <input
              id="autoSens"
              type="range"
              min="0.00"
              max="3.00"
              step="0.01"
              value="0.60"
              title="How strongly typing rate boosts impact and glow."
            />
          </div>
        </details>
      </div>

      <!-- PARTICLE SYSTEM -->
      <div class="control-group">
        <h3>Particle System</h3>
        <p class="group-desc">Controls the light bursts that appear when you type.</p>

        <div class="xypad-container" id="bias-pad-container"></div>

        <!-- Critical at-a-glance controls -->
        <div class="control-row">
          <label for="lightStrength">Light Strength</label>
          <span class="val" id="lightStrengthVal">2.00</span>
          <input
            id="lightStrength"
            type="range"
            min="0.00"
            max="10.00"
            step="0.01"
            value="2.00"
            title="Global light macro: scales brightness, count, size."
          />
        </div>

        <div class="control-row">
          <label for="impact">Keystroke Impact</label>
          <span class="val" id="impactVal">0.75</span>
          <input
            id="impact"
            type="range"
            min="0.00"
            max="5.00"
            step="0.01"
            value="0.75"
            title="Additive brightness per key press (multiplier)."
          />
        </div>

        <details class="advanced">
          <summary>Advanced</summary>
          <div class="control-row">
            <label for="burstAlpha">Burst Opacity</label>
            <span class="val" id="burstAlphaVal">0.15</span>
            <input
              id="burstAlpha"
              type="range"
              min="0.00"
              max="1.00"
              step="0.01"
              value="0.15"
              title="Extra multiplier applied to newly spawned particles' alpha. Lower makes single bursts dimmer so multiple key presses accumulate glow."
            />
          </div>

          <div class="control-row">
            <label for="emitAngleDeg">Emit Angle (deg)</label>
            <span class="val" id="emitAngleDegVal">5.0</span>
            <input
              id="emitAngleDeg"
              type="range"
              min="0.0"
              max="10.0"
              step="0.1"
              value="5.0"
              title="Maximum diagonal tilt from vertical for emission (each side)."
            />
          </div>

          <div class="control-row">
            <label for="originX">Origin X</label>
            <span class="val" id="originXVal">0.00</span>
            <input
              id="originX"
              type="range"
              min="-0.50"
              max="0.50"
              step="0.01"
              value="0.00"
              title="Horizontal offset of the emission origin (world units)."
            />
          </div>

          <div class="control-row">
            <label for="originY">Origin Y</label>
            <span class="val" id="originYVal">0.00</span>
            <input
              id="originY"
              type="range"
              min="-0.50"
              max="0.50"
              step="0.01"
              value="0.00"
              title="Vertical offset of the emission origin (world units)."
            />
          </div>

          <div class="control-row">
            <label for="partBright">Particle Brightness</label>
            <span class="val" id="partBrightVal">0.40</span>
            <input
              id="partBright"
              type="range"
              min="0.00"
              max="2.00"
              step="0.01"
              value="0.40"
              title="Base alpha per particle before impact/auto boosts."
            />
          </div>

          <div class="control-row">
            <label for="partCount">Particle Count</label>
            <span class="val" id="partCountVal">0.50</span>
            <input
              id="partCount"
              type="range"
              min="0.00"
              max="3.00"
              step="0.01"
              value="0.50"
              title="Multiplier for particles spawned per burst."
            />
          </div>

          <div class="control-row">
            <label for="partSize">Particle Size</label>
            <span class="val" id="partSizeVal">1.20</span>
            <input
              id="partSize"
              type="range"
              min="0.00"
              max="5.00"
              step="0.01"
              value="1.20"
              title="Base particle size (sprite pixels scaled by perspective)."
            />
          </div>

          <div class="control-row">
            <label for="minSat">Min Saturation</label>
            <span class="val" id="minSatVal">0.75</span>
            <input
              id="minSat"
              type="range"
              min="0.50"
              max="1.00"
              step="0.01"
              value="0.75"
              title="Lower clamp on particle color saturation (HSL). Higher values prevent desaturation."
            />
          </div>

          <div class="control-row">
            <label for="hueJitter">Hue Jitter (°)</label>
            <span class="val" id="hueJitterVal">8</span>
            <input
              id="hueJitter"
              type="range"
              min="0"
              max="180"
              step="1"
              value="8"
              title="Random hue offset per burst (degrees)."
            />
          </div>
        </details>
      </div>

      <!-- GLASS PRESETS -->
      <div class="control-group">
        <h3>Glass Presets</h3>
        <p class="group-desc">Quick styles for the frosted glass diffusion layer.</p>
        <div id="glassPresets" class="preset-buttons">
          <button data-glass="frosted">Frosted Flat</button>
          <button data-glass="deep">Deep Diffusion</button>
          <button data-glass="curved">Curved Lens</button>
        </div>
      </div>

      <!-- GLASS & GRAIN -->
      <div class="control-group">
        <h3>Glass & Grain</h3>
        <p class="group-desc">
          Controls the frosted glass overlay and noise grain texture.
        </p>

        <div class="xypad-container" id="blur-pad-container"></div>

        <div class="control-row">
          <label for="glassAlpha">Glass Tint</label>
          <span class="val" id="glassAlphaVal">0.06</span>
          <input
            id="glassAlpha"
            type="range"
            min="0.00"
            max="1.00"
            step="0.01"
            value="0.06"
            title="Dark blue tint over glass (rgba alpha)."
          />
        </div>

        <details class="advanced">
          <summary>Advanced</summary>
          <div class="control-row">
            <label for="blurMin">Glass Blur Min</label>
            <span class="val" id="blurMinVal">24</span>
            <input
              id="blurMin"
              type="range"
              min="0"
              max="200"
              step="1"
              value="24"
              title="Lower bound of frosted glass blur (px)."
            />
          </div>

          <div class="control-row">
            <label for="blurMax">Glass Blur Max</label>
            <span class="val" id="blurMaxVal">10</span>
            <input
              id="blurMax"
              type="range"
              min="0"
              max="200"
              step="1"
              value="10"
              title="Upper bound of frosted glass blur (px)."
            />
          </div>

          <div class="control-row">
            <label for="grainOpacity">Grain Opacity</label>
            <span class="val" id="grainOpacityVal">0.00</span>
            <input
              id="grainOpacity"
              type="range"
              min="0.00"
              max="2.00"
              step="0.01"
              value="0.00"
              title="Visibility of dark glass grain overlay."
            />
          </div>

          <div class="control-row">
            <label for="grainScale">Grain Scale</label>
            <span class="val" id="grainScaleVal">256</span>
            <input
              id="grainScale"
              type="range"
              min="32"
              max="1024"
              step="8"
              value="256"
              title="Tile size of the grain texture (px)."
            />
          </div>

          <div class="control-row">
            <label for="grainSpeed">Grain Speed</label>
            <span class="val" id="grainSpeedVal">18</span>
            <input
              id="grainSpeed"
              type="range"
              min="0"
              max="500"
              step="1"
              value="18"
              title="Scroll speed of the tiled grain overlay."
            />
          </div>
        </details>
      </div>

      <!-- SCENE -->
      <div class="control-group">
        <h3>Scene</h3>
        <p class="group-desc">Overall scene appearance and performance settings.</p>

        <div class="control-row">
          <label for="bgDark">Background Darkness</label>
          <span class="val" id="bgDarkVal">0.00</span>
          <input
            id="bgDark"
            type="range"
            min="-2.00"
            max="2.00"
            step="0.01"
            value="0.00"
            title="Darken/lighten the scene background from base #0b0f12."
          />
        </div>

        <div class="control-row">
          <label for="timeScale">Time Scale</label>
          <span class="val" id="timeScaleVal">1.00</span>
          <input
            id="timeScale"
            type="range"
            min="0.10"
            max="2.00"
            step="0.01"
            value="1.00"
            title="Global simulation speed multiplier. 0.5 = half speed, 2.0 = double speed."
          />
        </div>

        <details class="advanced">
          <summary>Advanced</summary>
          <div class="control-row">
            <label for="hz120">High Refresh 120 Hz</label>
            <span class="val"></span>
            <input
              id="hz120"
              type="checkbox"
              title="Targets ~120 fps on fast GPUs: lowers blur cost, reduces particle count, and tightens the pixelRatio governor."
            />
          </div>
          <div class="control-row">
            <label for="ditherFilm">Film Grain</label>
            <span class="val"></span>
            <input
              id="ditherFilm"
              type="checkbox"
              title="Adds subtle colored film grain to help hide banding."
            />
          </div>
          <div class="control-row">
            <label for="ditherStrength">Dither Strength</label>
            <span class="val" id="ditherStrengthVal">0.50</span>
            <input
              id="ditherStrength"
              type="range"
              min="0.00"
              max="2.00"
              step="0.05"
              value="0.50"
              title="Tiny offset before gamma to hide banding (in 1/255 steps)."
            />
          </div>

          <div class="control-row">
            <label for="ditherMode">Dither Mode</label>
            <span class="val"></span>
            <select id="ditherMode" title="Choose dithering pattern">
              <option value="auto" selected>Auto</option>
              <option value="ordered">Ordered</option>
              <option value="white">White</option>
            </select>
          </div>

          <div class="control-row">
            <label for="ditherTemporal">Temporal Jitter</label>
            <span class="val"></span>
            <input
              id="ditherTemporal"
              type="checkbox"
              checked
              title="Animate dithering slightly over time to avoid patterns."
            />
          </div>

          <div class="control-row">
            <label for="ditherChroma">Film Chroma</label>
            <span class="val" id="ditherChromaVal">0.15</span>
            <input
              id="ditherChroma"
              type="range"
              min="0.00"
              max="0.30"
              step="0.01"
              value="0.15"
              title="Amount of colored grain mixed into luminance dither."
            />
          </div>
        </details>
      </div>

      <!-- CONFIG JSON -->
      <div class="control-group">
        <h3>Configuration</h3>
        <p class="group-desc">Save or load the full configuration as JSON.</p>

        <div class="control-row">
          <button id="exportJson" class="config-btn">Export JSON</button>
        </div>

        <div class="control-row">
          <button id="importJson" class="config-btn">Import JSON</button>
          <input
            id="importJsonFile"
            type="file"
            accept="application/json"
            style="display: none"
          />
        </div>
      </div>
    </div>

    <!-- Placeholders for assets (actual textures are generated at runtime) -->
    <!-- These files are included to satisfy the requested structure. -->
    <!-- assets/noise-grain-256.png and assets/particle-soft.png are generated to data URLs in JS. -->

    <script type="module" src="src/main.js"></script>
  </body>
</html>
